# +---------------+
# | Powerlevel10k |
# +---------------+
if [[ $TERM_PROGRAM != "WarpTerminal" ]]; then
  # Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.config/zsh/.zshrc.
  if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
    source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
  fi

  source $ZDOTDIR/plugins/powerlevel10k/powerlevel10k.zsh-theme

  # To customize prompt, run `p10k configure` or edit ~/.config/zsh/.p10k.zsh.
  [[ ! -f ~/.config/zsh/.p10k.zsh ]] || source ~/.config/zsh/.p10k.zsh
fi

# Needed?
# Add plugins directory to fpath
# fpath=($ZDOTDIR/plugins $fpath)
unsetopt beep

# +--------+
# | Colors |
# +--------+
source $ZDOTDIR/plugins/zcolors/zcolors.plugin.zsh
source $ZDOTDIR/.zcolors
eval "$(dircolors -b $ZDOTDIR/dircolors-solarized.256dark)"

# +--------------+
# | Key Bindings |
# +--------------+
source $ZDOTDIR/key-bindings.zsh

# +------------+
# | Navigation |
# +------------+
setopt AUTO_CD              # If the command is a dirname perform cd
setopt AUTO_PUSHD           # Push the old directory onto the stack on cd.
setopt PUSHD_IGNORE_DUPS    # Do not store duplicates in the stack.

# +---------+
# | History |
# +---------+
# if export in zshenv or zprofile will be overwrited by /etc/zshrc
export HISTSIZE=50000            # Maximum events for internal history
export SAVEHIST=50000            # Maximum events in history file
# Dont save to history file this commands
export HISTORY_IGNORE="(l *|la *|ll *|lla *|lsd *|ls *|cd|pwd|exit)" 
setopt EXTENDED_HISTORY          # Write the history file in the ':start:elapsed;command' format.
setopt SHARE_HISTORY             # Share history between all sessions.
setopt HIST_EXPIRE_DUPS_FIRST    # Expire a duplicate event first when trimming history.
setopt HIST_IGNORE_DUPS          # Do not record an event that was just recorded again.
setopt HIST_IGNORE_ALL_DUPS      # Delete an old recorded event if a new event is a duplicate.
setopt HIST_FIND_NO_DUPS         # Do not display a previously found event.
setopt HIST_IGNORE_SPACE         # Do not record an event starting with a space.
setopt HIST_SAVE_NO_DUPS         # Do not write a duplicate event to the history file.
setopt HIST_VERIFY               # Do not execute immediately upon history expansion.

# +---------+
# | Aliases |
# +---------+
source $ZDOTDIR/aliases

### ZOXIDE
eval "$(zoxide init zsh)"

### FZF
[ -f $ZDOTDIR/.fzf.zsh ] && source $ZDOTDIR/.fzf.zsh

### LESPIPPE
export LESSOPEN="| $(which src-hilite-lesspipe.sh) %s"
export LESS=' -R -X -F '

## FASD
# Check
# eval "$(fasd --init auto)"
# alias fe="fasd -ae"


#
### Completion
#

# ctrl-x h show completion contexts
source $ZDOTDIR/completion.zsh

source $ZDOTDIR/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh

# FZF-TAB
# ctrl-x h show completion contexts
source $ZDOTDIR/plugins/fzf-tab/fzf-tab.plugin.zsh

# fzf-tab-previews
# https://github.com/Freed-Wu/fzf-tab-source
# https://github.com/Aloxaf/fzf-tab/wiki/Configuration
# to debug fzf-tab variables
# zstyle ':fzf-tab:complete:cd:*' fzf-preview 'echo  desc: $desc\\n realpath: $realpath \\n words: $words \\n word: $word \\n group: $group'
zstyle ':fzf-tab:complete:cd:*' fzf-preview 'exa -l --color=always $realpath'


# Note the source command must be at the end of ~/.zshrc.
source $ZDOTDIR/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
